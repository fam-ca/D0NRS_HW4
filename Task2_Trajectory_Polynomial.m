clear all;
close all;
t = 2;

T = [1 0 0 0 0 0;
    0 1 0 0 0 0;
    0 0 2 0 0 0;
    1 t t^2 t^3 t^4 t^5;
    0 1 2*t 3*t^2 4*t^3 5*t^4;
    0 0 2 6*t 12*t^2 20*t^3];
Q = [0 0 0;
    0 0 0;
    0 0 0;
    2 3 4;
    0 0 0;
    0 0 0];
A = T^-1*Q;
t = 0:0.1:2;
q1 = A(1,1) + A(2,1)*t + A(3,1)*t.^2 + A(4,1)*t.^3 + A(5,1)*t.^4 + A(6,1)*t.^5;
vel1 = diff(q1);
acc1 = diff(vel1);
q2 = A(1,2) + A(2,2)*t + A(3,2)*t.^2 + A(4,2)*t.^3 + A(5,2)*t.^4 + A(6,2)*t.^5;
vel2 = diff(q2);
acc2 = diff(vel2);
q3 = A(1,3) + A(2,3)*t + A(3,3)*t.^2 + A(4,3)*t.^3 + A(5,3)*t.^4 + A(6,3)*t.^5;
vel3 = diff(q3);
acc3 = diff(vel3);
figure;
plot(t,q1,'r',t,q2,'k',t,q3,'b');
title('Position vs time');
xlabel('time, s');
ylabel('Position, rad');
legend('Joint 1','Joint 2','Joint 3','Location','northwest');
figure;
plot(t(1:length(t)-1),vel1,'r',t(1:length(t)-1),vel2,'k',t(1:length(t)-1),vel3,'b');
title('Velocity vs time');
xlabel('time, s');
ylabel('Velocity, rad/s');
legend('Joint 1','Joint 2','Joint 3');

figure;
plot(t(1:length(t)-2),acc1,'r',t(1:length(t)-2),acc2,'k',t(1:length(t)-2),acc3,'b');
title('Acceleration vs time');
xlabel('time, s');
ylabel('Acceleration, rad/s^2');
legend('Joint 1','Joint 2','Joint 3');
